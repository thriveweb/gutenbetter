name: Build Plugin ZIP

on:
  release:
    types: [created]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Create Plugin ZIP
        run: |
          plugin_slug="gutenbetter"
          mkdir "$plugin_slug"
          rsync -av --progress . "$plugin_slug" --exclude ".git*" --exclude ".github" --exclude "*.zip"
          zip -r "$plugin_slug.zip" "$plugin_slug"

      - name: Upload Release Asset
        uses: softprops/action-gh-release@v1
        with:
          files: gutenbetter.zip
